<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Hesaplar</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
      h1 { margin-bottom: 12px; }
      .toolbar { display:flex; gap:12px; align-items:flex-end; margin:14px 0; flex-wrap:wrap; }
      .btn { background:#2563eb; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer }
      .btn-danger { background:#ef4444; }
      .btn-secondary { background:#6b7280; }
      input[type=text], input[type=number], select { padding:6px 8px; border:1px solid #ddd; border-radius:6px; }
      table { width: 100%; border-collapse: collapse; margin-top: 18px; }
      th, td { padding: 8px 12px; border-bottom: 1px solid #f0f0f0; text-align: left; font-size: 14px; }
      th { background: #fafafa; position: sticky; top: 0; }
      .grid { display:grid; grid-template-columns: 1fr; gap:18px; }
      @media (min-width: 1100px) { .grid { grid-template-columns: 1fr 1fr; } }
      .card { border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; background:#fff; }
      .card h2 { margin: 0; padding: 12px 16px; background: #f9fafb; border-bottom: 1px solid #e5e7eb; font-size: 16px; }
      .card .body { padding: 12px 16px; }
      .row { display:flex; gap:12px; flex-wrap:wrap; }
      .field { display:block; }
      .field label { display:block; font-size:12px; color:#374151; margin-bottom:4px; }
      .muted { color:#6b7280; font-size:12px; }
      .balance-positive { color: #059669; font-weight: 600; }
      .balance-negative { color: #dc2626; font-weight: 600; }
      .balance-zero { color: #6b7280; }
      a { color: #2563eb; text-decoration: none; }
      a:hover { text-decoration: underline; }
    </style>
  </head>
  <body>
    {% include "_nav.html" %}
    <h1>Hesaplar</h1>

    <div class="grid">
      <div class="card">
        <h2>Yeni Hesap Ekle</h2>
        <div class="body">
          <form method="post" action="/accounts/add" class="row">
            <div class="field">
              <label>Hesap Adı</label>
              <input type="text" name="name" placeholder="örn. Ana Banka Hesabı" required />
            </div>
            <div class="field">
              <label>Tür</label>
              <select name="type" required>
                <option value="bank">Banka</option>
                <option value="safe">Kasa</option>
                <option value="cash">Nakit</option>
                <option value="other">Diğer</option>
              </select>
            </div>
            <div class="field">
              <label>IBAN / Tanımlayıcı</label>
              <input type="text" name="iban" placeholder="Opsiyonel" />
            </div>
            <div class="field">
              <label>Başlangıç Bakiyesi</label>
              <input type="number" step="0.01" name="initial_balance" value="0" />
            </div>
            <div class="field" style="min-width:280px; flex:1">
              <label>Notlar</label>
              <input type="text" name="notes" placeholder="Opsiyonel" />
            </div>
            <div style="align-self:flex-end">
              <button class="btn" type="submit">Kaydet</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h2>Hesaplar ve Bakiyeler</h2>
      <div class="body" style="padding:0">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Ad</th>
              <th>Tür</th>
              <th>IBAN/Tanımlayıcı</th>
              <th>Başlangıç Bakiyesi</th>
              <th>Güncel Bakiye</th>
              <th>Durum</th>
              <th>İşlemler</th>
            </tr>
          </thead>
          <tbody>
            {% for acc in accounts %}
            {% if acc.id %}
            <tr>
              <td>{{ acc.id }}</td>
              <td>{{ acc.name }}</td>
              <td>{{ acc.type }}</td>
              <td>{{ acc.iban or '-' }}</td>
              <td>{{ '%.2f'|format(acc.initial_balance or 0) }} ₺</td>
              <td>
                {% set balance = balances.get(acc.id, 0.0) %}
                <span class="{% if balance > 0 %}balance-positive{% elif balance < 0 %}balance-negative{% else %}balance-zero{% endif %}">
                  {{ '%.2f'|format(balance) }} ₺
                </span>
              </td>
              <td>{{ 'Aktif' if acc.is_active else 'Pasif' }}</td>
              <td>
                <a href="/accounts/{{ acc.id }}/transactions">İşlemler</a>
              </td>
            </tr>
            {% endif %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>

