<style>
  .topnav { margin:12px 0 18px 0; background:#0f172a; color:#e5e7eb; border-radius:10px; border:1px solid #0b1220; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
  .topnav .inner { display:flex; align-items:center; gap:14px; padding:10px 12px; position:relative; }
  .topnav a { color:#e5e7eb; text-decoration:none; font-size:14px; }
  .topnav .brand { font-weight:600; padding:6px 10px; border-radius:6px; background:#0b1220; border:1px solid rgba(255,255,255,0.06); }
  .menu { display:flex; align-items:center; gap:8px; }
  .menu-item { position:relative; }
  .menu-item > a { display:inline-block; padding:6px 10px; border-radius:6px; }
  .menu-item > a:hover { background:#1f2a44; }
  .submenu { display:none; position:absolute; top:100%; left:0; min-width:200px; background:#0f172a; border:1px solid #0b1220; border-radius:8px; padding:6px; box-shadow:0 8px 24px rgba(0,0,0,0.25); z-index:50; }
  .submenu a { display:block; padding:8px 10px; border-radius:6px; color:#e5e7eb; }
  .submenu a:hover { background:#1f2a44; }
  .menu-item.has-sub:hover .submenu { display:block; }
  .spacer { flex:1; }
  .logout { background:#ef4444; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer; }
  @media (max-width: 900px){
    .menu { flex-wrap: wrap; }
  }
</style>
<nav class="topnav">
  <div class="inner">
    <a class="brand" href="/dashboard">Panel</a>
    <div class="menu">
      <div class="menu-item has-sub">
        <a href="#">Veri</a>
        <div class="submenu">
          <a href="/clients/table">Müşteriler</a>
          <a href="/items/table">Varyantlar</a>
          <a href="/products/table">Ürünler</a>
          <a href="/inventory/table">Stok</a>
          <a href="/inventory/movements/table">Stok Hareketleri</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">Satış</a>
        <div class="submenu">
          <a href="/orders/table">Siparişler</a>
          <a href="/payments/table">Ödemeler</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">Instagram</a>
        <div class="submenu">
          <a href="/ig/inbox">Gelen Kutusu</a>
          <a href="/ig/ai/process">AI İşleme</a>
          <a href="/ig/ai/unlinked">Bağlanmamış Satın Alımlar</a>
          <a href="/ig/ai/link-suggest">Konuşma Bağlama</a>
          <a href="/ig/debug/env">Debug Env</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">İçe Aktarma</a>
        <div class="submenu">
          <a href="/mappings/table">Haritalandırma</a>
          <a href="/import/map?source=bizim&filename=last">Haritalandırma Sihirbazı</a>
          <a href="/reconcile/returns">İade/Değişim Eşleştirme</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">Raporlar</a>
        <div class="submenu">
          <a href="/reports/daily">Günlük</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">Yönetim</a>
        <div class="submenu">
          <a href="/noc">NOC</a>
          <a href="/admin/status">Sistem Durumu</a>
          <a href="/admin/health">Health (JSON)</a>
          <a href="/admin/version">Version (JSON)</a>
          <a href="/admin/fix/message-timestamps">Mesaj Zaman Düzelt</a>
          <a href="/admin/reimport/raw-json">Mesaj Raw JSON Yeniden Al</a>
          <a href="/admin/debug/jobs?kind=ingest">Jobs (ingest)</a>
          <a href="/admin/debug/attachments">Attachments (JSON)</a>
          <a href="/admin/debug/conversations">Conversations (JSON)</a>
          <a href="#" id="invalidateCacheLink">Cache Temizle</a>
        </div>
      </div>
      <div class="menu-item has-sub">
        <a href="#">Yasal</a>
        <div class="submenu">
          <a href="/privacy">Gizlilik</a>
          <a href="/terms">Koşullar</a>
          <a href="/data_deletion">Veri Silme</a>
        </div>
      </div>
    </div>
    <div class="spacer"></div>
    <button id="logoutBtn" class="logout" type="button">Çıkış</button>
  </div>
  
</nav>
<script>
  (function(){
    const btn = document.getElementById('logoutBtn');
    if (btn) {
      btn.addEventListener('click', async ()=>{
        try { await fetch('/auth/logout', { method: 'POST' }); location.href = '/auth/login'; } catch(e){ alert('Çıkış hatası'); }
      });
    }
    const inv = document.getElementById('invalidateCacheLink');
    if (inv) {
      inv.addEventListener('click', async (e)=>{
        e.preventDefault();
        try {
          const res = await fetch('/admin/cache/invalidate', { method: 'POST' });
          let msg = 'Önbellek temizlendi';
          try { const j = await res.json(); if (!res.ok) msg = 'Hata: ' + (j && (j.detail||j.error) || res.status); } catch(_e) {}
          alert(msg);
        } catch(e){ alert('Temizleme hatası'); }
      });
    }
  })();
</script>


