<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Stok Hareketleri</title>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px 12px; border-bottom: 1px solid #f0f0f0; text-align: left; font-size: 14px; }
        th { background: #fafafa; position: sticky; top: 0; }
        tr:nth-child(even) { background: #fcfcfd; }
        .toolbar { margin: 12px 0; display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        a { color: #2563eb; text-decoration: none; }
        .pill { font-size: 12px; padding: 2px 8px; background: #eef2ff; color: #4338ca; border-radius: 999px; }
    </style>
</head>
<body>
    {% include "_nav.html" %}
    <h2>Stok Hareketleri</h2>
    <form method="get" action="/inventory/movements/table" class="toolbar">
        <label>Baslangic <input type="date" name="start" value="{{ start or '' }}" /></label>
        <label>Bitis <input type="date" name="end" value="{{ end or '' }}" /></label>
        <label>Item ID <input type="number" name="item_id" value="{{ item_id or '' }}" /></label>
        <label>Order ID <input type="number" name="related_order_id" value="{{ related_order_id or '' }}" /></label>
        <label>Limit <input type="number" name="limit" value="{{ limit or 500 }}" /></label>
        <button type="submit">Filtrele</button>
        <a href="/inventory/movements/table" style="font-size:12px;color:#6b7280;">Temizle</a>
        <span class="pill">{{ rows|length }} hareket</span>
    </form>
    <table>
        <thead>
            <tr><th>ID</th><th>Tarih</th><th>Yon</th><th>Miktar</th><th>Item</th><th>Order</th></tr>
        </thead>
        <tbody>
            {% for m in rows %}
            <tr>
                <td>{{ m.id }}</td>
                <td>{{ m.created_at }}</td>
                <td>{{ m.direction }}</td>
                <td>{{ m.quantity }}</td>
                <td>
                    {% if m.item_id %}
                        {% set it = item_map.get(m.item_id) %}
                        {% if it %}<a href="/items/table#{{ it.id }}">#{{ it.id }} {{ it.name }}</a>{% else %}#{{ m.item_id }}{% endif %}
                    {% else %}-{% endif %}
                </td>
                <td>
                    {% if m.related_order_id %}
                        {% set o = order_map.get(m.related_order_id) %}
                        {% if o %}<a href="/orders/table#{{ o.id }}">#{{ o.id }} {{ o.tracking_no or '' }}</a>{% else %}#{{ m.related_order_id }}{% endif %}
                    {% else %}-{% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>


